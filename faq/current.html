<!doctype html>
<html lang=en id=faq>

<title>Following -current and using snapshots</title>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/faq/current.html">

<h2 id=OpenBSD>
<a href="../index.html">
<i>Open</i><b>BSD</b></a>
Following -current and using snapshots
<small>
<a href="index.html">[FAQ Index]</a>
</small>
</h2>
<hr>

<p>
Active OpenBSD development is known as the
<a href="faq5.html#Flavors">-current</a> branch.
These sources are frequently compiled into releases known as <i>snapshots</i>.

<p>
Aggressive changes are sometimes pushed in this branch, and complications can
arise when building the latest code or upgrading from a previous point in time.
Some of the steps for getting over these hurdles are explained on this page.
Make sure you've read and understand how to
<a href="faq5.html">build the system from source</a> before using -current
and the instructions below.

<p>
In general, it's far easier to use snapshots, as developers will have gone
through much of the trouble for you already.

<p>
You should <b>always</b> use a snapshot as the starting point for running
-current.
This process typically consists of running
<a href="https://man.openbsd.org/sysupgrade">sysupgrade(8)</a> with the
<code>-s</code> flag.
Alternatively, download (and verify) the appropriate
<a href="faq4.html#bsd.rd">bsd.rd</a> file from the <code>/snapshots/</code>
directory of your preferred <a href="../ftp.html">mirror</a>, boot from it,
and choose <code>(U)pgrade</code> at the prompt.
Any installed packages should then be
<a href="faq15.html#PkgUpdate">upgraded</a> after booting into the new system.

<p>
Upgrading to -current by compiling your own source code is discouraged
for everyone except for experts, as difficult build-time crossing-points
can occur often, and no assistance will be provided.  In case of failure,
use a snapshot to recover.

<p>
Most of these changes will have to be performed as root.


<h3 id="r20221005">2022/10/05 - tftpd(8) read-only by default</h3>
<a href="https://man.openbsd.org/tftpd.8">tftpd(8)</a> now serves files in
read-only mode.
Use the new <code>-w</code> option to enable write access (old default).


<h3 id="r20221104">2022/11/04 - [packages] www/gitea PLIST change</h3>
Gitea static files location was changed from
<code>/usr/local/share/gitea/public/</code> to
<code>/var/www/gitea/public/</code> and
<code>/usr/local/share/gitea/public</code> is now a symlink
to <code>/var/www/gitea/public/</code>. This allows serving static files
by local http server for better performance.

Due to <code>/usr/local/share/gitea/public</code> type changing from
directory to symlink, upgrading gitea package using <code>pkg_add -u</code>
will fail.

To upgrade, delete gitea package, then add the updated version:

<blockquote><pre>
# pkg_delete gitea; pkg_add gitea
</pre></blockquote>


<h3 id="r20221107">2022/11/07 - TCP timer sysctls now use seconds</h3>
<tt>net.inet.tcp.keepidle</tt> and <tt>net.inet.tcp.keepintvl</tt>
are now specified in seconds.<p>

They were previously specified in units of a clock ticking
<tt>net.inet.tcp.slowhz</tt> times per second (typically, half-seconds).
If you have changed them (for example, in conjunction with
<tt>net.inet.tcp.alwayskeepalive=1</tt> to keep NAT or firewall states
alive if you are behind a router which times out quickly), you may need
to adapt them.


<h3 id="r20221115">2022/11/15 - [packages] PostgreSQL major update</h3>

<p>
There was a major update to PostgreSQL 15.1.
Use <tt>pg_upgrade</tt> as described in the
<a href="https://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/databases/postgresql/pkg/README-server?rev=1.35&amp;content-type=text/plain">postgresql-server pkg-readme</a>
or do a dump/restore.


<h3 id="r20230118">2023/01/18 - [packages] gotweb (devel/got,web) removed</h3>

<p>
The gotweb package has been removed since it is no longer maintained upstream.
The successor to gotweb is gotwebd, which serves FastCGI directly
instead of relying on
<a href="https://man.openbsd.org/slowcgi.8">slowcgi(8)</a> and www/kcgi
as gotweb did.
gotwebd provides improved performance and caching.

<p>
Users should install the gotwebd package:

<blockquote><pre>
# pkg_add gotwebd
</pre></blockquote>

<p>
Setting up gotwebd is similar to setting up gotweb.
Instructions are provided in manual pages installed by the
gotwebd package:
<ul>
<li><a href="https://gameoftrees.org/gotwebd.8.html">gotwebd(8)</a>
<li><a href="https://gameoftrees.org/gotwebd.conf.5.html">gotwebd.conf(5)</a>
</ul>

<p>
Before removing the gotweb package, gotwebd can be configured in
<a href="https://man.openbsd.org/httpd.conf.5">httpd.conf(5)</a>
to serve the same set of Git repositories under a different URL location,
for testing purposes.

<p>
Once gotwebd works as expected, 
<a href="https://man.openbsd.org/httpd.8">httpd(8)</a> can be reconfigured
to expose the former gotweb URL location using gotwebd, and the gotweb package
can be removed:

<blockquote><pre>
# pkg_delete gotweb
</pre></blockquote>


<h3 id="r20230214">2023/02/14 - [packages] Puppetserver and Puppetdb 7</h3>

<p>
Puppet and Puppetdb 5, and with that, the ability to run Puppet in master mode
were removed recently.
As their successors, Puppet, Puppetdb and Puppetserver 7 were added.
<p>
Users who intend to run a Puppet server should install the puppetserver package:

<blockquote><pre>
# pkg_add puppetserver
</pre></blockquote>

<p>
The new Puppetserver requires some initial bootstrapping, which is described in
<code>/usr/local/share/doc/pkg-readmes/puppetserver</code>.


<!--
     Two blank lines before new sections.
     New sentences start on new lines.
     Try to make lines shorter than 80 characters.
-->

<hr id="end">
<small>$OpenBSD: current.html,v 1.1103 2023/02/16 15:06:48 sebastia Exp $</small>
