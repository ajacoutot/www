<!doctype html>
<html lang=en id=plus>
<meta charset=utf-8>
<title>OpenBSD -current Changelog</title>
<meta name="description" content="OpenBSD -current changes">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/plus.html">
<style>
strong {
	color: var(--red);
	font-weight: normal;
}

h3 {
	color: var(--blue);
}
</style>

<h2 id=OpenBSD>
<a href="index.html">
<i>Open</i><b>BSD</b></a>
-current Changelog
</h2>
<hr>

<p>
This selection is intended to include all important
and all user-visible changes.
For a complete record of all changes, please see the "source-changes"
mailing list, called "OpenBSD CVS"
in the <a href="https://marc.info/?l=openbsd-cvs">archives</a>,
or use <a href="anoncvs.html#CVS">CVS</a>.

<p>
For changes in other releases, click below:<br>
<a href="plus20.html">2.0</a>,
<a href="plus21.html">2.1</a>,
<a href="plus22.html">2.2</a>,
<a href="plus23.html">2.3</a>,
<a href="plus24.html">2.4</a>,
<a href="plus25.html">2.5</a>,
<a href="plus26.html">2.6</a>,
<a href="plus27.html">2.7</a>,
<a href="plus28.html">2.8</a>,
<a href="plus29.html">2.9</a>,
<a href="plus30.html">3.0</a>,
<a href="plus31.html">3.1</a>,
<a href="plus32.html">3.2</a>,
<a href="plus33.html">3.3</a>,
<a href="plus34.html">3.4</a>,
<a href="plus35.html">3.5</a>,
<a href="plus36.html">3.6</a>,
<br>
<a href="plus37.html">3.7</a>,
<a href="plus38.html">3.8</a>,
<a href="plus39.html">3.9</a>,
<a href="plus40.html">4.0</a>,
<a href="plus41.html">4.1</a>,
<a href="plus42.html">4.2</a>,
<a href="plus43.html">4.3</a>,
<a href="plus44.html">4.4</a>,
<a href="plus45.html">4.5</a>,
<a href="plus46.html">4.6</a>,
<a href="plus47.html">4.7</a>,
<a href="plus48.html">4.8</a>,
<a href="plus49.html">4.9</a>,
<a href="plus50.html">5.0</a>,
<a href="plus51.html">5.1</a>,
<a href="plus52.html">5.2</a>,
<a href="plus53.html">5.3</a>,
<br>
<a href="plus54.html">5.4</a>,
<a href="plus55.html">5.5</a>,
<a href="plus56.html">5.6</a>,
<a href="plus57.html">5.7</a>,
<a href="plus58.html">5.8</a>,
<a href="plus59.html">5.9</a>,
<a href="plus60.html">6.0</a>,
<a href="plus61.html">6.1</a>,
<a href="plus62.html">6.2</a>,
<a href="plus63.html">6.3</a>,
<a href="plus64.html">6.4</a>,
<a href="plus65.html">6.5</a>,
<a href="plus66.html">6.6</a>,
<a href="plus67.html">6.7</a>,
<a href="plus68.html">6.8</a>,
<a href="plus69.html">6.9</a>,
<a href="plus70.html">7.0</a>.
<br>

<p>
<h3>Changes made between OpenBSD 7.0 and -current</h3>
<p>

<ul>
<!-- 2021/10/27 -->
<li>When downloading resident keys from a FIDO token, made <a href="https://man.openbsd.org/ssh.1">ssh(1)</a> pass back the user ID that was used when the key was created and append it to the filename the key was written to (if not the default).
<!-- 2021/10/26 -->
<li>Unlocked the <a href="https://man.openbsd.org/kevent.2">kevent(2)</a> system call.
<li>Updated to libfido2 1.8.0.
<li>Made <a href="https://man.openbsd.org/iked.conf.5">iked.conf(5)</a> proto config option accept a list to allow specifying multiple protocols for a single policy.
<li>Improved unhibernate performance by skipping attach of irrelevant devices.
<li>Enabled <a href="https://man.openbsd.org/vmx.4">vmx(4)</a> on arm64.
<li>Cleaned up irrelevant uses of 3rd mode_t parameter for <a href="https://man.openbsd.org/open.2">open(2)</a>/<a href="https://man.openbsd.org/openat.2">openat(2)</a>, unused when not creating files.
<li>Ensured armv7 and arm64 efiboot allocate fresh memory for the device tree with at least one page of free space to extend into. This fixes booting on VMWare Fusion.
<li>Added rejection of malformed Subject Alternative Names at certificate creation time to LibreSSL.
<!-- 2021/10/25 -->
<li>Added a way to force a color to RGB in <a href="https://man.openbsd.org/tmux.1">tmux(1)</a> and a format to display it.
<li>Fixed <a href="https://man.openbsd.org/pfctl.8">pfctl(8)</a> $nr incorrect macro expansion.
<li>Fixed <a href="https://man.openbsd.org/vi.1">vi(1)</a> use after free with unsaved buffer.
<li>Added -s and -S to <a href="https://man.openbsd.org/tmux.1">tmux(1)</a> display-popup to set popup and border style.
<li>Fixed application-set fg and bg in <a href="https://man.openbsd.org/tmux.1">tmux(1)</a> panes.
<!-- 2021/10/24 -->
<li>Added <a href="https://man.openbsd.org/httpd.8">httpd(8)</a> custom error page facility.
<li>Added mount -ur/uw support to tmpfs.
<li>Unlocked top part of UVM fault hander on mips64.
<li>Used <a href="https://man.openbsd.org/unveil.2">unveil(2)</a> for the possible <a href="https://man.openbsd.org/btrace.8">btrace(8)</a> script file, <a href="https://man.openbsd.org/dt.4">dt(4)</a> and <a href="https://man.openbsd.org/ksyms.4">ksyms(4)</a> nodes.
<li>Used <a href="https://man.openbsd.org/ifconfig.8">ifconfig(8)</a> "join" command by default in <a href="https://man.openbsd.org/hostname.if.5">hostname.if(5)</a> files, replacing the old "nwid".
<li>Switched <a href="https://man.openbsd.org/nsd.8">nsd(8)</a> to enable default DNS cookies on, matching behavior as released in OpenBSD 7.0.
<li>Updated to <a href="https://man.openbsd.org/nsd.8">nsd(8)</a> 4.3.8.
<li>Implemented <a href="https://man.openbsd.org/poll.2">poll(2)</a>, <a href="https://man.openbsd.org/select.2">select(2)</a>, <a href="https://man.openbsd.org/ppoll.2">ppoll(2)</a> and <a href="https://man.openbsd.org/pselect.2">pselect(2)</a> on top of kqueue.
<li>Stopped prompting whether to fall back to HTTP in the installer, making the fallback automatic.
<li>Fixed a panic by prohibiting renames of tmpfs mount-points.
<li>Set klist lock for sockets to make socket event filters MP-safe.
<li>Made pipe event filters MP-safe.
<!-- 2021/10/23 -->
<li>In <a href="https://man.openbsd.org/httpd.8">httpd(8)</a>, stopped sending content alongside responses to HEAD requests.
<li>Stopped duplicating "Connection: close" headers in <a href="https://man.openbsd.org/relayd.8">relayd(8)</a>, only adding it if it's not a websocket response.
<li>Provided common <a href="https://man.openbsd.org/btrace.8">btrace(8)</a> scripts kprofile.bt (to save kernel stackframes and produce flamegraphs) and runqlat.bt (to measure the latency of the scheduler runqueues).
<li>Added call to <a href="https://man.openbsd.org/unveil.2">unveil(2)</a> to restrict <a href="https://man.openbsd.org/stty.1">stty(1)</a> -f filesystem access.
<li>Added support for tpm2 CRB interface to <a href="https://man.openbsd.org/tpm.4">tpm(4)</a>, fixing recent S4 regressions on the Surface Go 2 caused by a firmware change.
<li>Retired asynchronous crypto API.
<li>Added new OpenSSL api SSL_write_ex, SSL_read_ex and SSL_peek_ex.
<li>Annotated an <a href="https://man.openbsd.org/httpd.8">httpd(8)</a> 413 error with "request body too large" in the error log.
<li>Fixed double free after allocation failure in <a href="https://man.openbsd.org/bpf.4">bpf(4)</a>.
<li>Provided a way to determine our maximum legacy version for TLS in libssl, unbreaking RSA KEX for the TLS client when the non-version specific method is used with TLSv1.0 or TLSv1.1.
<li>Called <a href="https://man.openbsd.org/pledge.2">pledge(2)</a> later to prevent it from killing various games using ncurses when both stdout and stderr are redirected to a non-tty.
<li>Removed unusable <a href="https://man.openbsd.org/route.8">route(8)</a> -T and exec support from ramdisk.
<li>Reinstated the fips mode test functions to libcrypto.
<li>Added <a href="https://man.openbsd.org/rcctl.8">rcctl(8)</a> "ls rogue" to show daemons which are running but not set as "enabled" in <a href="https://man.openbsd.org/rc.conf.local.8">rc.conf.local(8)</a>.
<li>Fixed a potential buffer overflow in <a href="https://man.openbsd.org/openssl.1">openssl(1)</a> certhash.
<!-- 2021/10/22 -->
<li>Renamed Pacific/Enderbury timezone to Pacific/Kanton.
<li>Fixed an interrupt storm on <a href="https://man.openbsd.org/dwge.4">dwge(4)</a> variants which support Energy Efficient Ethernet when connected to a switch which does so as well.
<li>Ensured enabled resolvers are honored by <a href="https://man.openbsd.org/unwind.8">unwind(8)</a> to keep unused forwarders disabled properly.
<li>Implemented <a href="https://man.openbsd.org/rsync.1">rsync(1)</a> --compare-dest, allowing specification of additional directories to check for files to be available.
<li>Prevented <a href="https://man.openbsd.org/ssh.1">ssh(1)</a> memory leak if getaddrinfo returns no addresses.
<li>Added protocol version checking to <a href="https://man.openbsd.org/httpd.8">httpd(8)</a>.
<!-- 2021/10/21 -->
<li>Ensured use of the correct encoding in xenocara when /etc/kbdtype is present with an attached <a href="https://man.openbsd.org/ucc.4">ucc(4)</a> keyboard.
<li>Removed hifn(4), safe(4) and ubsec(4) crypto drivers.
<li>Removed <a href="https://man.openbsd.org/fdisk.8">fdisk(8)</a> "disk" editing command.
<li>Fixed <a href="https://man.openbsd.org/httpd.8">httpd(8)</a> to respond with 400 Bad Request when a client sends header lines without a colon.
<li>Bumped to LibreSSL 3.5.0.
<li>Added -T to set a popup title in <a href="https://man.openbsd.org/tmux.1">tmux(1)</a>.
<!-- 2021/10/20 -->
<li>Stopped ignoring <a href="https://man.openbsd.org/carp.4">carp(4)</a> interfaces in <a href="https://man.openbsd.org/dhcpleased.8">dhcpleased(8)</a>.
<!-- 2021/10/19 -->
<!-- 2021/10/18 -->
<li>Removed an unused decoding of c/h/s from the MBR read from disk by <a href="https://man.openbsd.org/fdisk.8">fdisk(8)</a>.
<!-- 2021/10/17 -->
<li>Updated to <a href="https://man.openbsd.org/xterm.1">xterm(1)</a> 369.
<!-- 2021/10/16 -->
<li>Corrected installer to use "inet autoconf" properly for <a href="https://man.openbsd.org/hostname.if.5">hostname.if(5)</a> files.
<!-- 2021/10/15 -->
<li>Returned to use of the SFTP protocol for <a href="https://man.openbsd.org/scp.1">scp(1)</a>.
<li>Added initial 40MHz support to the <a href="https://man.openbsd.org/iwx.4">iwx(4)</a> driver.
<li>Fixed a problem with repeat in <a href="https://man.openbsd.org/tmux.1">tmux(1)</a> copy mode.
<!-- 2021/10/14 -->
<li>Released <a href="https://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-3.4.1-relnotes.txt">LibreSSL 3.4.1</a>.
<li>Replaced <a href="https://man.openbsd.org/lrint.3">lrint(3)</a>, <a href="https://man.openbsd.org/lrintf.3">lrintf(3)</a>, <a href="https://man.openbsd.org/llrint.3">llrint(3)</a> and <a href="https://man.openbsd.org/llrintf.3">llrintf(3)</a> implementations from NetBSD with the existing FreeBSD implementations we were already using for <a href="https://man.openbsd.org/lrintl.3">lrintl(3)</a> and <a href="https://man.openbsd.org/llrintl.3">llrintl(3)</a>.
<li>Fixed a <a href="https://man.openbsd.org/tmux.1">tmux(1)</a> redraw problem on automargin terminals.
<!-- 2021/10/13 -->
<li>Modified <a href="https://man.openbsd.org/syslog.conf.5">syslog.conf(5)</a> examples to use TLS rather than the plaintext protocols.
<li>Fixed file descriptor leak of /dev/tty on <a href="https://man.openbsd.org/doas.1">doas(1)</a> auth failure.
<li>Added <a href="https://man.openbsd.org/realpath.1">realpath(1)</a>, a wrapper for <a href="https://man.openbsd.org/realpath.3">realpath(3)</a> for use in ports.
<!-- 2021/10/12 -->
<li>Enabled enforcing of RLIMIT_MEMLOCK on powerpc64.
<li>Reverted to use <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> firmware v17 on Intel AC 7265, fixing instability issues on X1 Carbon gen3.
<li>Cached the old BSSID when roaming with <a href="https://man.openbsd.org/iwx.4">iwx(4)</a>.
<li>Explicitly stopped <a href="https://man.openbsd.org/iwx.4">iwx(4)</a> Rx block ack when roaming between access points.
<!-- 2021/10/11 -->
<li>Added support for 802.11n 40MHz channels to the <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> driver.
<li>Added monitoring of 20/40MHz channel width changes in beacons sent by our access point, notifying drivers when the channel width has changed.
<!-- 2021/10/10 -->
<li>Added support for 40MHz channels to net80211 RA.
<li>Fixed establishing legacy INTx interrupts on machines without a (usable) MSI interrupt controller.
<!-- 2021/10/09 -->
<li>Merged bugfixes from upstream into <a href="https://man.openbsd.org/less.1">less(1)</a> including fixes for the prompt hiding feature (CTRL-P) and an integer overflow.
<!-- 2021/10/08 -->
<!-- 2021/10/07 -->
<li>Cached the old BSSID when roaming with <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> so firmware commands can continue using it while roaming to a new AP.
<!-- 2021/10/06 -->
<li>Stopped <a href="https://man.openbsd.org/pkg_add.1">pkg_add(1)</a> from communicating warnings starting with "XXX" which appeared to indicate errors.
<li>Ensured <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> uses only the HT (high throughput) frame format for data frames.
<li>Allowed AUTH->AUTH state transitions in the <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> and <a href="https://man.openbsd.org/iwx.4">iwx(4)</a> drivers again, needed if the access point uses band-steering.
<li>Removed the <a href="https://man.openbsd.org/ifconfig.8">ifconfig(8)</a> autoconfprivacy deprecation warning.
<!-- 2021/10/05 -->
<li>Retired the Loongson platform.
<li>Fixed <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> performance drop after roaming between APs in 11n mode.
<!-- 2021/10/04 -->
<li>Applied a workaround in <a href="https://man.openbsd.org/mvkpcie.4">mvkpcie(4)</a> to fix an external abort under load with <a href="https://man.openbsd.org/athn.4">athn(4)</a>.
<!-- 2021/10/03 -->
<li>Added relicensed wireless firmwares from Realtek for <a href="https://man.openbsd.org/rsu.4">rsu(4)</a>, <a href="https://man.openbsd.org/rtwn.4">rtwn(4)</a> and <a href="https://man.openbsd.org/urtwn.4">urtwn(4)</a> devices, allowing these devices to work without requiring a separate firmware download.
<li>Added a workaround for buggy <a href="https://man.openbsd.org/athn.4">athn(4)</a> devices to prevent filling up the node cache when used in hostap mode.
<!-- 2021/10/02 -->
<li>Made redistributable firmwares available across all architectures.
<li>Fixed memory leak in <a href="https://man.openbsd.org/fuse.4">fuse(4)</a> when calling <a href="https://man.openbsd.org/namei.9">namei(9)</a>.
<li>Fixed a panic when <a href="https://man.openbsd.org/iwx.4">iwx(4)</a> cannot find firmware at boot time.
<!-- 2021/10/01 -->
<li>Released LibreSSL <a href="https://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-3.3.5-relnotes.txt">3.3.5</a> and <a href="https://ftp.openbsd.org/pub/OpenBSD/LibreSSL/libressl-3.2.7-relnotes.txt">3.2.7</a>.
<!-- 2021/09/30 -->
<li>Enabled X509_V_FLAG_TRUSTED_FIRST by default in the legacy verifier.
<li>Deleted expired DST Root CA X3.
<li>Prevented <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> and <a href="https://man.openbsd.org/iwx.4">iwx(4)</a> attempts to transition toward the same state where this would result in a redundant or illegal state transition and a potential hang.
<!-- 2021/09/29 -->
<li>Removed the constraint that <a href="https://man.openbsd.org/fdisk.8">fdisk(8)</a> -b specified block count or block size must be greater than 63.
<li>Added support to <a href="https://man.openbsd.org/pchgpio.4">pchgpio(4)</a> for Cannon Lake H and Tiger Lake H platforms.
<!-- 2021/09/28 -->
<!-- 2021/09/27 -->
<li>Fixed a crash in <a href="https://man.openbsd.org/tmux.1">tmux(1)</a> when a session with multiple clients is destroyed but tmux does not close completely due to other sessions.
<!-- 2021/09/26 -->
<!-- 2021/09/25 -->
<li>Introduced <a href="https://man.openbsd.org/gpiocharger.4">gpiocharger(4)</a>, a driver providing support for battery chargers connected to GPIO pins, such as those found on the Pinebook Pro.
<li>Introduced <a href="https://man.openbsd.org/gpioleds.4">gpioleds(4)</a> for arm64, a driver providing support for LEDs connected to GPIO pins, such as those found on the Pinebook Pro.
<!-- 2021/09/24 -->
<li>Reset the Tx timer upon validation of a BA notification sent by <a href="https://man.openbsd.org/iwx.4">iwx(4)</a> and <a href="https://man.openbsd.org/iwm.4">iwm(4)</a> firmware.
<!-- 2021/09/23 -->
<li>Added support to <a href="https://man.openbsd.org/umb.4">umb(4)</a> for SIMCom SIM7600.
<li>Released <a href="https://man.openbsd.org/rpki-client.8">rpki-client</a> 7.3.
<li>Removed wpath from <a href="https://man.openbsd.org/less.1">less(1)</a> secure mode pledge.
<li>Added <a href="https://man.openbsd.org/iwx.4">iwx(4)</a> Tx aggregation support.
<li>Added an ADDBA_OFFLOAD capability for wifi devices to manage Tx block ack sessions entirely in firmware.
<li>Released <a href="https://man.openbsd.org/bgpd.8">OpenBGPD</a> 7.2.
<!-- 2021/09/22 -->
<li>Cleared length of keys in <a href="https://man.openbsd.org/vnconfig.8">vnconfig(8)</a> alongside keys themselves.
</ul>
